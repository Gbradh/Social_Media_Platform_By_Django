{% extends "base.html" %}
{% load static %}
{% load humanize %}
{% block content %}
<div class="columns is-centered">
  <div class="column">
    <div class="card">
      <div class="card-image">
        <div class="slideshow-container">
          {% for cont in post.content.all %}
          <!-- Full-width images with number and caption text -->
          <div class="mySlides">
            <center>
            {% if cont.file.name|slice:"-4:" == 'apng' or cont.file.name|slice:"-4:" == 'aPNG' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/apng" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-4:" == 'avif' or cont.file.name|slice:"-4:" == 'aVIF'%}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/avif" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-3:" == 'gif' or cont.file.name|slice:"-3:" == 'GIF' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/gif" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-3:" == 'jpg' or cont.file.name|slice:"-4:" == 'jpeg' or cont.file.name|slice:"-4:" == 'jfif' or cont.file.name|slice:"-5:" == 'pjpeg' or cont.file.name|slice:"-3:" == 'pjp' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/jpeg" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-3:" == 'JPG' or cont.file.name|slice:"-4:" == 'JPEG' or cont.file.name|slice:"-4:" == 'JFIF' or cont.file.name|slice:"-5:" == 'pJPEG' or cont.file.name|slice:"-3:" == 'pJP' %}
            <a href="{{ cont.get_absolute_url }}">
              <img src="{{ cont.file.url }}" type="image/jpeg" alt="Placeholder image">
            </a>
            {% elif cont.file.name|slice:"-3:" == 'png' or cont.file.name|slice:"-3:" == 'PNG' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/png" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-3:" == 'svg' or cont.file.name|slice:"-3:" == 'SVG' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/svg+xml" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-4:" == 'webp' or cont.file.name|slice:"-4:" == 'WebP' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/webp" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-3:" == 'bmp' or cont.file.name|slice:"-3:" == 'BMP' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/bmp" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-3:" == 'ico' or cont.file.name|slice:"-3:" == 'ICO' or cont.file.name|slice:"-3:" == 'cur' or cont.file.name|slice:"-3:" == 'CUR' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/x-icon" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-3:" == 'tif' or cont.file.name|slice:"-3:" == 'TIF' or cont.file.name|slice:"-4:" == 'tiff' or cont.file.name|slice:"-4:" == 'TIFF' %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}">
                <img src="{{ cont.file.url }}" type="image/webp" alt="Placeholder image">
              </a>
            </figure>
            {% elif cont.file.name|slice:"-4:" == 'webm' or cont.file.name|slice:"-4:" == 'WebM' %}
<!--            <center>-->
              <video href="{{ cont.get_absolute_url }}" controls="controls" preload="metadata">
                <source src="{{ cont.file.url }}#t=0.5" type="video/webm">
              </video>
<!--            </center>-->
            {% elif cont.file.name|slice:"-3:" == 'mp4' or cont.file.name|slice:"-3:" == 'MP4' %}
<!--            <center>-->
              <video href="{{ cont.get_absolute_url }}" controls="controls" preload="metadata">
                <source src="{{ cont.file.url }}#t=0.5" type="video/mp4">
              </video>
<!--            </center>-->
            {% elif cont.file.name|slice:"-3:" == 'ogg' or cont.file.name|slice:"-3:" == 'Ogg' %}
<!--            <center>-->
              <video href="{{ cont.get_absolute_url }}" controls="controls" preload="metadata">
                <source src="{{ cont.file.url }}#t=0.5" type="video/ogg">
              </video>
<!--            </center>-->
            {% elif cont.file.name|slice:"-3:" == 'mp3' or cont.file.name|slice:"-3:" == 'MP3' or cont.file.name|slice:"-3:" == 'mpeg' or cont.file.name|slice:"-3:" == 'MpeG' %}
<!--            <center>-->
              <!-- <img src="{% static 'img/default/music_icon.jpg' %}" alt="Placeholder image"> -->
              <audio href="{{ cont.get_absolute_url }}" controls="controls" preload="metadata">
                <source src="{{ cont.file.url }}#t=0.5" type="audio/mpeg">
              </audio>
<!--            </center>-->
            {% elif cont.file.name|slice:"-4:" == 'wav' or cont.file.name|slice:"-4:" == 'wav' %}
<!--            <center>-->
              <!-- <img src="{% static 'img/default/music_icon.jpg' %}" alt="Placeholder image"> -->
              <audio href="{{ cont.get_absolute_url }}" controls="controls" preload="metadata">
                <source src="{{ cont.file.url }}#t=0.5" type="audio/wav">
              </audio>
<!--            </center>-->
            {% elif cont.file.name|slice:"-4:" == 'ogg' or cont.file.name|slice:"-4:" == 'Ogg' %}
<!--            <center>-->
              <!-- <img src="{% static 'img/default/music_icon.jpg' %}" alt="Placeholder image"> -->
              <audio href="{{ cont.get_absolute_url }}" controls="controls" preload="metadata">
                <source src="{{ cont.file.url }}#t=0.5" type="audio/ogg">
              </audio>
<!--            </center>-->
            {% else %}
            <figure class="image">
              <a href="{{ cont.get_absolute_url }}" class="btn btn-danger" download="{{ cont.file.url }}">
                <img src="{% static 'img/default/document_icon.jpg' %}" alt="Placeholder image">
                <strong>$Download</strong>
              </a>
            </figure>
            {% endif %}
            </center>
          </div>
          {% endfor %}
          <!-- Next and previous buttons -->
          <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
          <a class="next" onclick="plusSlides(1)">&#10095;</a>
        </div>
      </div>
      <div class="card-content">
        <div class="media">

          <div class="media-left">
            <figure class="image is-48x48">
              {% if post.user.profile.picture %}
                <img src="{{ post.user.profile.picture.url }}" alt="Placeholder image">
              {% else %}
                <img src="{% static 'img/default/default.jpg' %}" alt="Placeholder image">
              {% endif %}
            </figure>
          </div>

          <div class="media-content">
            {% if post.user.profile.first_name %}
              <a href="{% url 'profile' post.user %}"><p class="title is-4">{{ post.user.profile.first_name }} {{ post.user.profile.last_name }}</p></a>
            {% else %}
              <a href="{% url 'profile' post.user %}"><p class="title is-4">{{ post.user.username }}</p></a>
            {% endif %}
            <a href="{% url 'profile' post.user %}"><p class="subtitle is-6">@{{ post.user.username }}</p></a>
            <hr>
            {% for tag in post.tags.all %}
              <a href="{{ tag.get_absolute_url }}" >
                <strong>{{ tag }}, </strong>
              </a>
            {% endfor %}

            <div class="content">
              {{ post.caption }}
              <p>
                <br>
              <strong><small>{{ post.posted|naturaltime }}</small></strong>
            </div>
          </div>

          {% if favorited is True %}
          <div class="media-right">
            <a href="{% url 'postfavorite' post.id %}" class="btn">
              <span class="material-icons has-text-danger">save_alt</span>
              <p>Remove</p>
            </a>
          </div>
          {% else %}
          <div class="media-right">
            <a href="{% url 'postfavorite' post.id %}" class="btn">
              <span class="material-icons has-text-success">save_alt</span>
              <p>Save</p>
            </a>
          </div>
          {% endif %}

          <div class="media-right">
            <a href="{% url 'postlike' post.id %}" class="btn">
              <span style="color:cyan" class="material-icons">ac_unit</span>
              <p>{{ post.likes }} Likes</p>
            </a>
          </div>
        </div>

      </div>
    </div>
    <div class="card-content">
    {% for comment in comments %}
    <article class="media">

      <figure class="media-left">
        <p class="image is-64x64">
          {% if comment.user.profile.picture %}
            <img src="{{ comment.user.profile.picture.url }}" alt="Placeholder image">
          {% else %}
            <img src="{% static 'img/default/default.jpg' %}" alt="Placeholder image">
          {% endif %}
        </p>
      </figure>

      <div class="media-content">
        <div class="content">
          <p>
            {% if comment.user.profile.first_name %}
            <strong>{{ comment.user.profile.first_name }} {{ comment.user.profile.last_name }}</strong>
            {% else %}
            <strong>@{{ comment.user.profile.user }}</strong>
            {% endif %}
            <br>
            {{ comment.body }}
            <br>
            <strong><small>{{ comment.date|naturaltime }}</small></strong>
          </p>
        </div>
      </div>
    </article>
    {% endfor %}

    <article class="media">
      <figure class="media-left">
        <p class="image is-64x64">
          {% if request.user.profile.picture %}
            <img src="{{ request.user.profile.picture.url }}" alt="Placeholder image">
          {% else %}
            <img src="{% static 'img/default/default.jpg' %}" alt="Placeholder image">
          {% endif %}
        </p>
      </figure>
      <div class="media-content">
        <form method="post" action="" role="form">
          {% csrf_token %}
          <div class="field">
            <p class="control">
              {{ form.body }}
            </p>
          </div>
          <div class="field">
            <p class="control">
              <button type="submit" name="action" class="button">Post comment</button>
            </p>
          </div>
        </form>
      </div>
    </article>
    </div>
  </div>
</div>
{% endblock %}
